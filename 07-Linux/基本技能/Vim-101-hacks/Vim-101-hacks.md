# Vim 101 HACKS

- 书籍作者: Ramesh Natarajan
- 笔记时间:2022.08.02

## 第一章 Vim基础

- 打开文件

  ```shell
  vim /etc/passwd
  ### vim 里面得操作
  :e /etc/passwd
  ```

- 保存文件

  ```shell
  :w 	#保存
  :w  filename #另存为
:u	#update ,作用等同w
  ```
  
- 关闭文件

  ```shell
  :wq	#保存并关闭
  :x
  ZZ
  :qa	#quit all,关闭所有打开的文件
  ```

- 不同模式

  | 模式        | 进入按键 | 作用                                   |
  | ----------- | -------- | -------------------------------------- |
  | Normal      | Esc      | 执行编辑命令(增删改查)                 |
  | Insert      | i/o/a... | 插入文本,正常的输入                    |
  | CommandLine | Esc :    | 执行命令,保存/配置等                   |
  | Visual      | v/V...   | 多行/多列选择                          |
  | Select      |          | 键入可打印字符将删除选择并开始插入模式 |
  | Ex          |          | 类似命令行,执行完成后仍然处于命令行    |

- 移动按键

  | 上   | 下   | 左   | 右   |
  | ---- | ---- | ---- | ---- |
  | ↑    | ↓    | ←    | →    |
  | j    | k    | h    | l    |

- Vim配置文件位置

  ```shell
  # ~/.vimrc,用于配置当前用户的vim
  # /etc/.vimrc	用于配置全局vim
  
  ```

- 查看帮助文档

  ```shell
  :help # 查看帮助文档,Ctrl-] 可以跳转到指定部分(需要在 ||链接里)
  :helpgrep pattern # 查询模式,使用:cn跳转下一个
  :help 'option'	#option是关键字,比如 nu/list等
  :help CTRL-X
  :help :x
  :help<CTRL-D>
  
  vimtutor #学习文档
  ```

## 第二章 导航

  - 页面导航
  
    | 快捷键 | 作用     | 助记        |
    | ------ | -------- | ----------- |
    | Ctrl-f | 翻下一页 | Forward     |
    | Ctrl-b | 翻上一页 | Backward    |
    | Ctrl-d | 翻下半页 | Down        |
    | Ctrl-u | 翻上半页 | Up          |
    | Ctrl-e | 翻下一行 | Extra Lines |
  | Ctrl-y | 翻上一行 |             |
  
  - 单词导航(小写word表示小写字母组成,WORD表示非空字符组成)
  
    | 快捷键 | 作用             | 助记   |
    | ------ | ---------------- | ------ |
    | w      | 下一个单词开头   | word   |
    | e      | 当前单词结尾     | end    |
    | b      | 前一个单词看开头 | before |
  
  - 行内导航
  
    | 快捷键 | 作用                     | 助记 |
    | ------ | ------------------------ | ---- |
    | 0      | 跳到行开头               |      |
    | $      | 跳到行尾部               |      |
    | ^      | 跳到行开头第一个非空字符 |      |
    | g_     | 跳到行尾最后一个非空字符 |      |
  
  - 段落导航
  
    | 快捷键  | 作用         | 助记 |
    | ------- | ------------ | ---- |
    | (  /  ) | 上下句子开头 |      |
    | { / }   | 上下段落开头 |      |
    | [[ / ]] | 上下会话开头 |      |




## 第三章 高级导航

- 屏幕导航

  | 快捷键                     | 作用                       | 助记   |
  | -------------------------- | -------------------------- | ------ |
  | H / z<ENTER>               | 当前屏幕开头               | Home   |
  | M / z.                     | 定位到屏幕中间             | Middle |
  | L  / z-                    | 定位到屏幕尾行             | Last   |
  | :0  / gg  / 1G             | 定位文件第一行             |        |
  | :$  / G                    | 定位文件最后一行           |        |
  | 5%                         | 定位5%行                   |        |
  | :goto 25                   | 定位文件开头第 25 个字符   |        |
  | 25\|                       | 当前行的第 25 个字符       |        |
  | :set nu/nonu/numberwidth=5 | 设置行号显示/关闭/行号宽度 |        |

- 源码导航

  | 快捷键         | 作用                   | 助记 |
  | -------------- | ---------------------- | ---- |
  | %              | 匹配括号的跳转         |      |
  | [(  / [[  / [{ | 跳到上一个未匹配的括号 |      |
  | shift-left     | 插入模式,左移一个单词  |      |

  

## 第四章 专家导航

- 跳转

  | 快捷键 | 作用             |      |
  | ------ | ---------------- | ---- |
  | :jumps | 查看跳转列表     |      |
  | Ctrl-i | 跳转下个编辑位置 |      |
  | Ctrl-o | 跳转上个编辑位置 |      |

- 长行内跳转(一个长行多行显示)

  | 快捷键         | 作用                     |      |
  | -------------- | ------------------------ | ---- |
  | gj             | 往下跳转一行             |      |
  | g^  /  g$  /gm | 跳转行开头 /  结尾 /中间 |      |
  |                |                          |      |

- Vim命令行跳转

  - vim +143 file,打开文件跳到143行
  - vim +?root  file,打开文件,搜索root

- 书签(配合ctags实现函数跳转)

  | 快捷键    | 作用                                         |      |
  | --------- | -------------------------------------------- | ---- |
  | ma        | 标记书签 a,小写字母局部书签,大写字母全局书签 |      |
  | `a  \| 'a | 跳转书签a高亮 \| 行首                        |      |
  | :marks    | 查看所有书签                                 |      |
  | `"        | 最后编辑位置                                 |      |
  | `[        | 上次改变位置                                 |      |
  | `.        | 最后改变位置                                 |      |
  | `^        | 上次插入位置                                 |      |

-  taglist 插件实现源码函数方法查看

## 第五章 文本操作

- 文本插入操作

  | 快捷键          | 作用               |      |
  | --------------- | ------------------ | ---- |
  | i/o/a           | 插入/新起一行/追加 |      |
  | :r file \| !cmd | 插入命令结果/文本  |      |
  | r/R/c/C         | 替换字符/若干字符  |      |
  | s/S             | 替换字符/替换行    |      |
  | J               | 文本拼接           |      |



## 第六章 高级文本操作

- 复制/粘贴

  | 快捷键                      | 作用                            |      |
  | --------------------------- | ------------------------------- | ---- |
  | yw / yy /...                | 复制                            |      |
  | p/P/...                     | 粘贴                            |      |
  | :reg                        | 查看复制缓冲区                  |      |
  | "3p                         | 粘贴3号缓冲区                   |      |
  | "*p  / shift-insert         | 粘贴剪切板                      |      |
  | :%y+   \|   :y+  \|  :N,My+ | 复制全文/当前行/指定行到剪切板4 |      |

- 写入文件/交换字符

  | 快捷键           | 作用                   |      |
  | ---------------- | ---------------------- | ---- |
  | :w filename      | 另存为,可以选择部分行  |      |
  | :5,10w  filename | 同上                   |      |
  | xp               | 组合键(复制-删除-粘贴) |      |

- 选择与操作

  | 快捷键                      | 作用                    |      |
  | --------------------------- | ----------------------- | ---- |
  | v/V/Ctrl-v                  | 视图模式,选择行/块      |      |
  | :g/^$/d                     | 正则,删除空行           |      |
  | :g/^\s*$/d                  | 正则,删除空格符组成的行 |      |
  | :g/^$/,/./-j                | 正则,压缩多行空行为一行 |      |
  | :g/pattern/ . w>>filename   | 正则,另存为             |      |
  | :g/^/m0                     | 正则,行翻转             |      |
  | :g!/Sales/d   \| :v/Sales/d | 正则,反向处理           |      |

  

## 第七章 专家文本操作

- 复制到不同缓冲区

  | 快捷键        | 作用                         |      |
  | ------------- | ---------------------------- | ---- |
  | "a5yy \|  "ap | 复制行到a  / 粘贴a缓冲区     |      |
  | <ESC>u@.      | 将插入模式的命令转为命令模式 |      |

- 缩写

  | 快捷键                               | 作用                     |                         |
  | ------------------------------------ | ------------------------ | ----------------------- |
  | :abbr US United States \| :noabbr US | 创建/删除缩写            |                         |
  | ia Britian Britain                   | 配置文件,自动补全/纠错等 | **autocorrect.vim**插件 |

- 宏操作

  | 快捷键 | 作用                      |      |
  | ------ | ------------------------- | ---- |
  | qa     | 开始记录到a,处理完用q结束 |      |
  | 100@a  | 调用宏100次               |      |

- 排序

  | 快捷键        | 作用                                  |      |
  | ------------- | ------------------------------------- | ---- |
  | :sort! i/u    | 块选,排序,i不分大小写,u是unique,!取反 |      |
  | “1pu.u.u.u.u. | 撤销删除                              |      |
  |               |                                       |      |

## 第八章 Vim作为代码编辑器

- 智能高亮/提示

  | 快捷键           | 作用                      |
  | ---------------- | ------------------------- |
  | :syn on \| off   | 打开高亮                  |
  | >  \| <          | 智能缩进                  |
  | K                | 获取man帮助文档           |
| gd \| gD         | 跳转到局部/全局变量声明处 |
  | Ctrl-A / Ctrl-X  | 光标指向数字,加一/减一    |
  | Ctrl-O           | 插入模式临时进入命令模式  |
  | Ctrl-G/ g Ctrl-G | 给出当前编辑文件信息      |
  
- align.vim插件可以辅助对齐

- 状态栏控制/大小写改变

  | 快捷键                   | 作用                           |
  | ------------------------ | ------------------------------ |
  | :set laststatus=2        | 打开状态条                     |
  | :set statusline=%t %l %c | 文件名/行号/列号               |
  | ~                        | 正常模式,改变一个字符大小写    |
  | g\~$/g\~\~               | 正常模式,改变一行大小写        |
  | gUU/guu/gUw              | 整行大写/小写/单词大写         |
  | U/u/~                    | 视图模式下大写/小写/切换大小写 |

- 拼写检查

  | 快捷键     | 作用                           |
  | ---------- | ------------------------------ |
  | :set spell | 开启拼写检查                   |
  | ]s  / [s   | 下/上一个错误拼写              |
  | z=  / zg   | 修正提示 / 将单词作为有效词    |
  | :confirm q | 退出确认                       |
  | :up        | 只有文件改变时候才会更新时间戳 |

- 编辑缓冲区内容

  | 快捷键                    | 作用              |
  | ------------------------- | ----------------- |
  | :bufdo ! 1,$ ! sed "...." | 使用sed编辑缓冲区 |

- tab键与空格

  | 快捷键         | 作用                    |
  | -------------- | ----------------------- |
  | :set expandtab | 将Tab转为8个空格        |
  | :set tabstop=4 | tab为4个空格            |
  | :retab         | 转换所有tab             |
  | :set ai        | 插入模式自动缩进,Ctrl-D |

  

## 第九章 Vim命令行

- 常用命令

  | 快捷键                      | 作用                    |
  | --------------------------- | ----------------------- |
  | vim -h                      | 查看所有命令            |
  | vim -R                      | 只读模式                |
  | vim -r                      | 列出交换文件            |
  | vim -c 'gg' filename        | 打开文件并执行          |
  | vim -w script filename      | 执行script里面的vim指令 |
  | vim --noplugin filename.txt | 临时关闭插件            |

## 第十章 gVim

- gVim配置

  | 快捷键                  | 作用                              |
  | ----------------------- | --------------------------------- |
  | :set guioptions-=T      | 关闭gVim菜单栏                    |
  | :set guioptions+=TmrlRL | 展示所有gVim的GUI元素             |
  | T/m/r/l/R/L             | Toolbar/menu/right-side-croll-bar |

- 感觉用处不大,不做笔记



## 第十一章 Vim外观与标签

- 分屏

  | 快捷键                          | 作用                |
  | ------------------------------- | ------------------- |
  | :split  / :vs  /  :sv  filename | 水平分屏 / 垂直分屏 |
  | Ctrl-w w/h/j/k/l                | 跳转窗口            |
  | ctrl-w +/-                      | 增加/减小窗口大小   |
  | :25 vsplit filename             | 指定列数分屏        |
  | :set title titlestring=aaa      | 设定窗口标题        |

- 主题

  | 快捷键                   | 作用 |
  | ------------------------ | ---- |
  | :! ls $VIMRUNTIME/colors |      |
  | :colorscheme blue        |      |

- 多标签

  | 快捷键        | 作用               |
  | ------------- | ------------------ |
  | vim -p a b c  | 多标签打开多个文件 |
  | :tabe file    | 新建标签           |
  | :tabs         | 查看所有标签       |
  | :tabn N       | 去第N个标签        |
  | :tabc         | 关闭标签           |
  | :tabn / :tabp | 下一个/上一个      |

## 第十二章 Vim额外特性

- 重复n次操作

  | 快捷键 | 作用             |
  | ------ | ---------------- |
  | @@     | 重复上一次宏操作 |
  | .      | 重复上次编辑操作 |
  | @:     | 重复上次命令行   |

- 取消/恢复

  | 快捷键        | 作用    |
  | ------------- | ------- |
  | 5u            | 取消5次 |
  | :red / Ctrl-R | 重做    |
  |               |         |

- 打开光标标明的文件

  | 快捷键    | 作用         |
  | --------- | ------------ |
  | gf        | 当前窗口打开 |
  | Ctrl-w f  | 新窗口打开   |
  | Ctrl-w gf | 新标签打开   |

- 编辑多个文件

  | 快捷键            | 作用             |
  | ----------------- | ---------------- |
  | :ls               | 查看所有打开文件 |
  | :e #N             | 编辑第N个文件    |
  | Ctrl-6            | 两个文件之间切换 |
  | :next / :previous | 下/上一个文件    |
  | :set autowrite    | 自动保存         |
  | :X                | 加密             |

- 保存现场环境/文件对比

  | 快捷键                | 作用                     |
  | --------------------- | ------------------------ |
  | :mksession            | 保存当前会话             |
  | vim -S Session.vim    | 还原会话                 |
  | :! echo % / %:p  /%:e | 打印文件名/全路径/扩展名 |
  | vimdiff a b           | 对比两个文件差异         |
  | :diffsplit            | 打开新窗口对比           |
  | [c  /  ]c             | 下/上一个不同处          |

- 命令映射

  | 快捷键                         | 作用                       |
  | ------------------------------ | -------------------------- |
  | :map  :write :!cc % && ./a.out | :write指定为c编译并运行    |
  | set -o vi                      | 让shell命令行跟vim一样操作 |
  | :set ic / list                 | 不分大小写 / 展示空白符号  |

- 寄存器/文件管理

  | 快捷键           | 作用                                          |
  | ---------------- | --------------------------------------------- |
  | % / # / : / "    | 当前文件名/替换文件名/最近执行命令/最近寄存器 |
  | vim dir          | 打开目录                                      |
  | D/R/X/o          | 删除目录/重命名/执行文件/打开文件             |
  | :Ex dirname      | 打开目录                                      |
  | :Sex /:Vex /:Tex | 水平/垂直/新标签打开目录                      |
  |                  |                                               |

## 第十三章 搜索

- 搜索跳转

  | 快捷键   | 作用                                 |
  | -------- | ------------------------------------ |
  | /  ?     | 前向/后向搜索                        |
  | n/N      | 下/上一个搜索词                      |
  | // ??    | 重复之前的搜索                       |
  | *  / #   | 下/上一个光标坐在单词                |
  | g* /  g# | 下/上一个光标所在单词,单词是部分匹配 |
  | [i       | 列出所有光标所在的相同单词           |

- 行内搜索

  | 快捷键  | 作用                                  |
  | ------- | ------------------------------------- |
  | fx/tx/; | 前向搜索字符x/目标后一个字符/重复前向 |
  | Fx/Tx/, | 反向                                  |
  |         |                                       |

- 替换

  | 快捷键                                 | 作用                                          |
  | -------------------------------------- | --------------------------------------------- |
  | :%s/old/new/gi                         | %文件范围,s替换,g每一行每个都替换,i忽略大小写 |
  | :s/helo/hello/g 4                      | 只替换接下去4行                               |
  | :s/\\<his\\>/her/                      | 准确替换单词                                  |
  | :s/\\(a\\|b)/c/g                       | 多项替换                                      |
  | :%s/^/\\=line(".") . ". "/g            | 增加行号 \\= 表示解析为命令,line获取行号      |
  | :%s!\\~!\\= expand($HOME)!g            | 替换特殊字符(路径替换)                        |
  | :4,$s/\d\\+/\\=submatch(0) + 1/        | 数字加一                                      |
  | :%s/\\.\s*\w/\\=toupper(submatch(0))/g | 句子首字母大写                                |
  | vimgrep json *.txt                     | 多文件搜索                                    |
  | :cn  / :cN  / :clist / :cc N           | 下/上一个/列出/跳到第N个                      |

   thegeekstuff.com 可以查看Vim相关的更多操作

- 搜索

  | 快捷键                  | 作用                                                 |
  | ----------------------- | ---------------------------------------------------- |
  | :set incsearch          | 增量搜索                                             |
  | :match ErrorMsg /Error/ | 匹配错误项目,高亮显示.还有WarningMsg/ModeMsg/ModeMsg |
  |                         |                                                      |

## 第十四章 自动补全

- 单词补全

  | 快捷键               | 作用             |
  | -------------------- | ---------------- |
  | Ctrl-X Ctrl-N/Ctrl-P | 单词补全         |
  | Ctrl-X Ctrl-L        | 行补全           |
  | Ctrl-X Ctrl-F        | 文件补全         |
  | Ctrl-X Ctrl-K        | 使用文件单词补全 |
  | Ctrl-X Ctrl-T        | 词典单词补全     |
  |                      |                  |
  |                      |                  |

- 目录补全需要在配置文件中设置

  ```shell
  ####  ~/.vimrc   ##########
  set dictionary+=/usr/share/dict/words
  
  # 词典单词补全#####
  set thesaurus+=/home/jsmith/mythesaurus.txt
  #### mythesaurus.txt#####
  important,valuable,substantial,significant
  ```

- 自动打开补全带单

  - autocomplpop 插件
  - word_complete.vim  单词补全提示

## 第十五章 额外技巧

- 插入项标记
  1. Ctrl-V选中第一列字符
  2. I (大写i) 输入需要的字符格式
  3. ESC 两次应用

- 设置vim为默认编辑器

  ` update-alternatives --set editor <PATH OF VIM>`  或者

  `export EDITOR=vi`

- 格式化 `gqap`

- 修改宏

  - "ap ==> 修改 ==> "app

- 代码缩进

  - 移动光标至 { / }  ==> >i{  进行缩进

- 刷新屏幕  `Ctrl-L`

- 光标在目标单词结尾  /pattern\zs

- 查看字符的ASCII , ga   | 编辑二进制文件  vim -b file

- 折叠 `:set foldmethod=indent`

  | 快捷键                            | 作用                     |
  | --------------------------------- | ------------------------ |
  | za / zR / zM                      | toggle/打开所有/折叠所有 |
  | :set foldmethod=manual            | 手动折叠                 |
  | zf X \| zf /pattern / :range fold | 折叠选定部分             |
  | :mkview  \| :loadview             | 保存折叠/加载折叠        |

  ​	









































































## 附录

- 快捷键映射

  ```shell
  ####  .vimrc    ######
  inoremap <F2>  <ESC>u@.		#将插入模式的命令转为指令模式执行
  
  vnoremap < <gv
  vnoremap > >gv				#视图模式缩进后保持选择状态
  ```

- 开关设置

  ```shell
  #### .vimrc    ######
  set nu						#开启行号
  syn on						#开启高亮
  

  
  ```
  
  