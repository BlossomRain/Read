# OpenCV快速入门

- 笔记时间：2022.1.12
- 来源[黑马](https://www.bilibili.com/video/BV1Fo4y1d7JL?p=2)

## 1 图像处理

- 图像处理
  - 二值图 ：0/1表示的图像，用于文字、OCR和掩膜图像存储
  - 灰度图：像素用一个字节表示256个界别的灰度
  - 彩色图：RGB表示
  - 图是物体反射或透射光的分布，像是人对图的感知

- 安装 -- 四个模块

  ```shell
  opencv-python  numpy matplotlib
  pip3 install opencv-contrib-python -i https://pypi.douban.com/simple
  ```

- core 核心模块，数据结构、接口、函数等

  highgui 视频图像读取、显示

  imgproc 实现图像的处理基础方法，滤波、几何变换、阈值分割等

- 形态学
  - 连通性
    - 4邻接、8邻接、D邻接
    - 连通性（像素相邻、灰度值相似）
      - 4连通：p在q的四邻域，8连通同理
      - m连通：4连通或者D连通，并且4邻域交集为空
  - 操作
    - 腐蚀：用一个结构扫描，若目标含有0则中心点置零，AND操作。效果消除物体边界，目标缩小。
    - 膨胀：与腐蚀相反，目标含有1则置一，OR操作。效果填充孔洞。
    - 开运算：先腐蚀再膨胀，消除噪点、小干扰块
    - 闭运算：先膨胀后腐蚀，消除空洞。
    - 礼帽：原图像-开运算，作用分离比临近点亮一些的斑块
    - 黑帽：闭运算-原图像，作用分离比临近点暗一些的斑块

- 图像平滑
  - 噪声
    - 椒盐噪声：卖出那个噪声，受到干扰，随机出现的黑点/白点
    - 高斯噪声：噪声密度函数服从高斯函数（正态分布函数）
  - 平滑
    - 均值滤波：由一个归一化卷积框完成，使用卷积框所有像素平均值替代中心元素。简单，会造成模糊。
    - 高斯滤波：中心点坐标（0，0），权重矩阵根据坐标得到对应的概率值，归一化，中心值则是加权平均数。RGB只需要每个通道滤波一次。
    - 中值滤波：使用像素点邻域灰度值中值替代该像素点灰度值。

- 直方图
  - 图像直方图：统计亮度值个数的直方图，根据灰度图统计，反应图片亮度分布情况（还可以统计梯度、色彩等等 ）
  - 掩膜：只对感兴趣区域进行处理，类似蒙版
  - 直方图均衡化：将图像进行拉伸，重新分配像素值，提高对比度
    - 自适应直方图均衡化： 分块均衡化，同时添加对比度上限，最后使用双线性差值对块进行拼接

- 边缘检测
  - 标识图像亮度变化明显的点，
    - 基于搜索：通过一阶导数最大值检测边界，通常采用梯度方向找到最大值，代表算法 Sobel算子和Scharr算子
    - 基于零穿越：通过二阶导数的零穿越，代表算法Laplacian算子
    - Canny边缘检测：
      1. 噪声去除，高斯滤波
      2. 图像梯度计算，Sobel算法
      3. 非极大值一致
      4. 滞后阈值

- 模板匹配：图片中查找和模板最相似的区域
  - 算法有 平方差、相关匹配、相关系数匹配，不适合变换后图像
- 霍夫变换：
  - 霍夫空间，用斜率和偏移作为坐标系的空间，一个点对应笛卡尔坐标系的一条直线，反之亦然。使用极坐标系便于处理垂直的情况
  - 圆检测：确定圆心和半径，使用霍夫梯度法减少维度，提高效率。用到了Canny边缘检测

- 图像特征：类似拼图，边角容易定位。
  - 角点特征
    - Harris角点检测：通过局部小窗口观察图像，任意角度移动都会发生灰度明显变化判断为角点
    - Shi-Tomasi 角点检测：前者的改进
  - SIFT（Scale-Invariant Feature Transform）尺度不变特征转换
    - 尺度空间极值检测，使用尺度空间滤波器，构建高斯差分金字塔

